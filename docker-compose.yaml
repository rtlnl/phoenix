version: '3'
services:
  # public:
  #   build: .
  #   command: []
  #   environment:
  #     - NODE_ENV=production
  #   ports:
  #     - 8080:8080
  #   depends_on:
  #     - aerospike
  
  # internal:
  #   build: .
  #   command: []
  #   environment:
  #     - DB_HOST=127.0.0.1
  #     - DB_PORT=3000
  #   ports:
  #     - 8081:8081
  #   depends_on:
  #     - aerospike

  aerospike:
    image: aerospike/aerospike-server
    container_name: aerospike
    command: ["--config-file", "/opt/aerospike/etc/aerospike.conf"]
    ports:
      - "3000:3000"
    volumes: 
      - ./data:/opt/aerospike/data
      - ./config/aerospike.conf:/opt/aerospike/etc/aerospike.conf

  localstack:
    container_name: localstack
    image: localstack/localstack
    ports:
      - "4572:4572"
      - "8080:8080"
    environment:
      - SERVICES=s3
      - DEFAULT_REGION=eu-west-1
      - DEBUG=1
      - DATA_DIR=/tmp/localstack/data
      - DOCKER_HOST=unix:///var/run/docker.sock
    volumes:
      - './.localstack:/tmp/localstack'

volumes:
  aerospike-data: